---
title: Gitæ–°æ‰‹æ•™ç¨‹-æ’¤é”€æ›´æ”¹(ä¸ƒ)
tags:
  - Git
categories:
  - Gitç›¸å…³
---

### å‰è¨€

åœ¨å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†æ ‡ç­¾ã€åˆ†æ”¯ã€å’Œåˆå¹¶ã€‚ç°åœ¨æˆ‘ä»¬å°†å­¦ä¹ Gitä¸­å¦å¤–çš„ä¸‰ä¸ªå‘½ä»¤`git commit --amend` , `git revert` , `git reset`ã€‚ä¸‹é¢ç®€å•çš„ä»‹ç»ä¸­å‡ ä¸ªå‘½ä»¤çš„åŠŸèƒ½ï¼š

- `git commit --amend` ï¼šå¯ä»¥ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤ä¸­çš„å†…å®¹ï¼ŒåŠ ä¸œè¥¿ï¼ŒåŠ æ–‡ä»¶ã€‚ä¿®æ”¹ commit ä¿¡æ¯ã€‚
- `git revert` ï¼šå¯ä»¥æ’¤é”€å¯¹åº”çš„ commit ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªæ–°çš„ commit ã€‚
- `git reset` ï¼šå¯ä»¥æ¸…é™¤æœ€è¿‘çš„ commit ã€‚å¹¶ä¸èƒ½ä»»æ„åˆ é™¤ï¼Œéœ€è¦æŒ‰ç…§é¡ºåºã€‚

### git commit --amend

åœ¨å¹³æ—¶çš„é¡¹ç›®å¼€å‘ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½æäº¤å®Œç›¸åº”æ–‡ä»¶åï¼Œæ‰å‘ç°æ¼æ‰äº†å‡ ä¸ªæ–‡ä»¶æ²¡æœ‰æ·»åŠ ï¼Œæˆ–è€…æˆ‘ä»¬ commit æ¶ˆæ¯å¹¶æ²¡æœ‰ä¹¦å†™å®Œæ•´æˆ–æœ‰é”™åˆ«å­—ã€‚é‚£è¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¯¥æ•´ä¹ˆåŠå‘¢ï¼Ÿæˆ–è®¸æˆ‘ä»¬ä¼šæ‰§è¡Œä¸€ä¸ªæ–°çš„æäº¤æ¥æ·»åŠ æˆ‘ä»¬é—æ¼çš„å†…å®¹ï¼Œä½†æ˜¯è¿™æ ·ä¸€ç‚¹éƒ½ä¸ä¼˜é›…ï¼ï¼åœ¨Gitä¸­ä¸ºæˆ‘ä»¬æä¾›äº†å¸¦æœ‰ `--amend` é€‰é¡¹çš„æäº¤æ¥ä¿®æ”¹æˆ‘ä»¬`æœ€è¿‘`çš„æäº¤:

> amend ä¸­æ–‡æ„æ€æ˜¯ä¿®æ”¹ã€æ”¹å–„ã€æ”¹è¿›ã€‚

```bash
git commit --amend
```

è¿™é‡Œå¤§å®¶å¯èƒ½è¿˜æ˜¯ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œæˆ‘ä»¬çœ‹ä¸‹é¢è¿™ä¸ªç®€å•çš„ä¾‹å­ï¼š

![æ’¤é”€æ›´æ”¹1.png](https://upload-images.jianshu.io/upload_images/2824145-d0b6ea830d1e9fe5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

åœ¨ä¸Šè¿°ä¾‹ä»“åº“ä¸­æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª commit ï¼Œè¯¥ commit æ¶ˆæ¯å¹¶æ²¡æœ‰ä¹¦å†™å®Œæ•´ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æƒ³ä¿®æ”¹å®ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å‘½ä»¤ `git commit --amend` ï¼Œå½“è¾“å…¥è¯¥å‘½ä»¤åï¼Œæˆ‘ä»¬èƒ½å¾—åˆ°å¦‚ä¸‹å¼¹çª—ï¼š

> ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ `git commit --amend -m + æäº¤ä¿¡æ¯` è·³è¿‡ç¼–è¾‘å™¨ï¼Œç›´æ¥ä¿®æ”¹ commit ä¿¡æ¯ã€‚

![æ’¤é”€æ›´æ”¹2.png](https://upload-images.jianshu.io/upload_images/2824145-0d525cb66eb42171.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å®Œå–„è¯¥ commit ä¿¡æ¯ï¼Œç„¶åä¿å­˜å¹¶ç¦»å¼€ã€‚è¿™é‡Œæˆ‘æ”¹æˆäº† `åˆ é™¤äº†å¤šä½™çš„è¯­å¥` ï¼Œè¿™æ—¶æˆ‘ä»¬å†ä½¿ç”¨ `git log` å‘½ä»¤ï¼Œæˆ‘ä»¬ä¼šå‘ç°æˆ‘ä»¬çš„ commit æ¶ˆæ¯å·²ç»è¢«æ›´æ”¹äº†ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š

![æ’¤é”€æ›´æ”¹3.png](https://upload-images.jianshu.io/upload_images/2824145-0de4916bf1cdc5f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å½“ç„¶åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•çš„ä¿®æ”¹äº† commit ä¿¡æ¯ï¼Œå¹¶æ²¡æœ‰ä¿®æ”¹æˆ–æ·»åŠ ä¸€äº›æ–°çš„æ–‡ä»¶ï¼Œå¦‚æœä½ ä¿®æ”¹æˆ–æ·»åŠ äº†æ–°çš„æ–‡ä»¶ï¼Œå¹¶æƒ³å°†è¿™äº›ä¿®æ”¹çš„æ–‡ä»¶æ·»åŠ åˆ°æœ€è¿‘çš„ commit ä¸­å»çš„è¯ï¼Œé‚£ä¹ˆä½ å¯èƒ½è¦ç»å†ä»¥ä¸‹æ­¥éª¤ï¼š

- ç¼–è¾‘æ–‡ä»¶
- ä¿å­˜æ–‡ä»¶
- æš‚å­˜æ–‡ä»¶ (git add)
- è¿è¡Œ git commit --amend

åœ¨å®é™…çš„é¡¹ç›®ä¸­ï¼Œå¦‚æœä½ æƒ³ä¿®æ”¹æœ€è¿‘çš„ commit ï¼Œé‚£ä¹ˆä½ éœ€è¦ä½¿ç”¨ `git commit --amend` æ¥æ›´æ–°æœ€è¿‘çš„ commit ï¼Œè€Œä¸æ˜¯åˆ›å»ºæ–°çš„ commit ã€‚

### git revert

åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•ä¿®æ”¹æœ€è¿‘çš„ commit ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³è¿˜åŸè¿™ä¸ª commit ã€‚é‚£è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `git revert` å‘½ä»¤æ¥å‘Šè¯‰ Git è¿˜åŸä¹‹å‰åˆ›å»ºçš„commitï¼Œè¯¥å‘½ä»¤ä½¿ç”¨çš„æ–¹å¼å¦‚ä¸‹ï¼š

> å½“ä½ å‘Šè¯‰ Git è¿˜åŸï¼ˆrevertï¼‰ å…·ä½“çš„ commit æ—¶ï¼Œgit ä¼šæ‰§è¡Œå’Œ commit ä¸­çš„æ›´æ”¹å®Œå…¨ç›¸åçš„æ›´æ”¹ã€‚å‡è®¾ commit A æ·»åŠ äº†ä¸€ä¸ªå­—ç¬¦ï¼Œå¦‚æœ Git è¿˜åŸ commit Aï¼Œé‚£ä¹ˆ Git å°†åˆ›å»ºä¸€ä¸ª `æ–°çš„ commit` ï¼Œå¹¶åˆ æ‰è¯¥å­—ç¬¦ã€‚å¦‚æœåˆ æ‰äº†ä¸€ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆè¿˜åŸè¯¥ commit å°†æŠŠè¯¥å†…å®¹æ·»åŠ å›æ¥ï¼

```bash
git revert <SHA-of-commit-to-revert>
```

è¿˜æ˜¯ä»¥ä¸Šè¿°ä¾‹å­æ¥è¿›è¡Œè®²è§£ï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¿˜åŸä¸‹å›¾ä¸­çº¢è‰²æ¡†ä¸­çš„ commit ï¼š

![æ’¤é”€æ›´æ”¹4.png](https://upload-images.jianshu.io/upload_images/2824145-0de4916bf1cdc5f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `git revert b71b40` ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨è¯¥å‘½ä»¤ï¼Œé»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

> è¿™é‡Œ `b71b40` æ˜¯å¯¹åº” commit çš„ SHA çš„å‰ä¸ƒä¸ªå­—ç¬¦ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å®Œæ•´çš„ SHA ã€‚

![æ’¤é”€æ›´æ”¹5.png](https://upload-images.jianshu.io/upload_images/2824145-e10e3a4bd493b3ce.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Gitç³»ç»Ÿé»˜è®¤çš„ revert ä¿¡æ¯ã€‚å½“æˆ‘ä»¬ä¿å­˜å¹¶é€€å‡ºåï¼Œå†ä½¿ç”¨ `git log` å‘½ä»¤æŸ¥çœ‹æˆ‘ä»¬çš„æ—¥å¿—æäº¤è®°å½•ï¼Œæˆ‘ä»¬èƒ½å¾—åˆ°ä¸‹å›¾ï¼š

![æ’¤é”€æ›´æ”¹6.png](https://upload-images.jianshu.io/upload_images/2824145-000528eef2e0175b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### git reset

#### git reset ç®€ä»‹

åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å­¦ä¼šäº†å¦‚ä½•è¿˜åŸä¸€ä¸ªæäº¤ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æœ¬æ˜¯è¿™ä¸ªæäº¤å°±æ˜¯é”™è¯¯çš„ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³è¦è¿™ä¸ªæäº¤ï¼Œä¹Ÿä¸æƒ³ä»“åº“è®°å½•ä¸­åŒ…å« `revert` çš„æäº¤è®°å½•ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬åˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `git reset` å‘½ä»¤æ¥å‘Šè¯‰ Git é‡ç½® commit ã€‚

é‡ç½®ï¼ˆresetï¼‰ ä¼¼ä¹å’Œ è¿˜åŸï¼ˆrevertï¼‰ ç›¸ä¼¼ï¼Œä½†å®ƒä»¬å®é™…ä¸Šå·®åˆ«å¾ˆå¤§ã€‚è¿˜åŸä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ commitï¼Œå¹¶è¿˜åŸæˆ–æ’¤æ¶ˆä¹‹å‰çš„ commitã€‚ä½†æ˜¯é‡ç½®ä¼šæ¸…é™¤ commitï¼

> `git reset` å‘½ä»¤æ˜¯å°‘æ•°å‡ ä¸ªå¯ä»¥ä»ä»“åº“ä¸­æ¸…é™¤ commit çš„å‘½ä»¤ï¼Œå¦‚æœæŸä¸ª commit ä¸å†å­˜åœ¨ä¸ä»“åº“ä¸­ï¼Œå®ƒæ‰€åŒ…å«çš„å†…å®¹ä¹Ÿä¼šæ¶ˆå¤±ã€‚ä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼ŒGit ä¼šåœ¨å®Œå…¨æ¸…é™¤ä»»ä½•å†…å®¹ä¹‹å‰ï¼ŒæŒç»­è·Ÿè¸ªæäº¤è®°å½•å¤§çº¦30å¤©ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `git reflog` æ¥æŸ¥çœ‹ä»“åº“ä¸­æ‰€æœ‰çš„æ”¹å˜ã€‚å…³äº `git reflog` ä½ å¯ä»¥æŸ¥çœ‹ä¸‹æ–¹å†…å®¹ï¼š

- [git reflog](https://git-scm.com/docs/git-reflog)
- [Rewriting history](https://www.atlassian.com/git/tutorials/rewriting-history)

#### git reset å‘½ä»¤çš„ä½¿ç”¨

`git reset` å‘½ä»¤ç›¸æ¯”å…¶ä»– Git å‘½ä»¤åŠŸèƒ½è¦å¤šä¸€ç‚¹ï¼Œå¯ä»¥ç”¨æ¥ï¼š

- å°† HEAD å’Œå½“å‰åˆ†æ”¯æŒ‡é’ˆç§»åˆ°ç›®æ ‡ commitã€‚
- æ¸…é™¤ commit ã€‚
- å°† commit çš„æ›´æ”¹ç§»åŠ¨åˆ°æš‚å­˜åŒºä¸­ã€‚
- å–æ¶ˆæš‚å­˜ commit çš„æ›´æ”¹ã€‚

`git reset` å¹¶ä¸ç›´æ¥ä½¿ç”¨ commit çš„ SHA ï¼Œè€Œæ˜¯ä½¿ç”¨ç‰¹æ®Šçš„ `"ç¥–å…ˆå¼•ç”¨"` æ¥å‘Šè¯‰ Git å°† `HEAD` æŒ‡é’ˆç§»åŠ¨åˆ°å“ªä¸ªcommitã€‚æˆ‘ä»¬æ¥çœ‹çœ‹è¿™äº›ç‰¹æ®Šçš„ç¬¦å·ã€‚

- `^` ï¼š è¡¨ç¤ºçˆ¶ commit
- `~` ï¼š è¡¨ç¤ºç¬¬ä¸€ä¸ªçˆ¶ commit

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¼•ç”¨ä¹‹å‰çš„ commitï¼š

- å½“å‰ commit çš„çˆ¶ commit

```bash
HEAD^
HEAD~
HEAD~1
```

- å½“å‰ commit çš„ç¥–çˆ¶ commit

```bash
HEAD^^
HEAD~2
```

- å½“å‰ commit çš„æ›¾ç¥–çˆ¶ commit

```bash
HEAD^^^
HEAD~3
```

`^` å’Œ `~` çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨é€šè¿‡åˆå¹¶è€Œåˆ›å»ºçš„ commit ä¸­ã€‚åˆå¹¶ commit å…·æœ‰ä¸¤ä¸ªçˆ¶çº§ã€‚å¯¹äºåˆå¹¶ commitï¼Œ`^` å¼•ç”¨ç”¨æ¥è¡¨ç¤ºç¬¬ä¸€ä¸ªçˆ¶ commitï¼Œè€Œ `^2` è¡¨ç¤ºç¬¬äºŒä¸ªçˆ¶ commitã€‚ç¬¬ä¸€ä¸ªçˆ¶ commit æ˜¯å½“ä½ è¿è¡Œ git merge æ—¶æ‰€å¤„çš„åˆ†æ”¯ï¼Œè€Œç¬¬äºŒä¸ªçˆ¶ commit æ˜¯è¢«åˆå¹¶çš„åˆ†æ”¯ã€‚

æˆ‘ä»¬çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œæ¥ä¸€èµ·æ¥ç†è§£ï¼š

> å¯ä»¥ä½¿ç”¨ `git log --oneline  --graph --all` æ¥æŸ¥çœ‹æ‰€æœ‰çš„åˆ†æ”¯ä¿¡æ¯ã€‚

![æ˜¾ç¤ºæ‰€æœ‰åˆ†æ”¯ä¿¡æ¯.png](https://upload-images.jianshu.io/upload_images/2824145-e19d7ffed53186d0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å› ä¸º `HEAD` æŒ‡å‘ `b71b405` commmitã€‚

- é‚£ä¹ˆ `f8d5383` commit æˆ‘ä»¬å¯ä»¥è¿™æ ·è¡¨ç¤ºï¼š
  - HEAD^
  - HEAD~1
- é‚£ä¹ˆ `9fdb3f6` commit æˆ‘ä»¬å¯ä»¥è¿™æ ·è¡¨ç¤ºï¼š
  - HEAD^^2ï¼ˆ `^2` è¡¨ç¤ºåˆå¹¶åˆ†æ”¯ä¸Šçš„çˆ¶æäº¤ï¼‰
- é‚£ä¹ˆ `48099db` commit æˆ‘ä»¬å¯ä»¥è¿™æ ·è¡¨ç¤ºï¼š
  - HEAD^^
  - HEAD~2

äº†è§£äº†ç¥–å…ˆå¼•ç”¨ï¼Œç°åœ¨æˆ‘ä»¬æ¥äº†è§£ `git reset` å‘½ä»¤çš„ä½¿ç”¨ï¼š

```bash
git reset <reference-to-commit>
```

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½¿ç”¨è¯¥å‘½ä»¤ï¼Œæˆ‘ä»¬ä¼šæ·»åŠ å¦‚ä¸‹é€‰é¡¹ï¼š

- `--mixed` (é»˜è®¤ä¸æŒ‡å®šä»»ä½•é€‰é¡¹)ç§»åŠ¨åˆ°å·¥ä½œç›®å½•ï¼Œä¸ä¼šæš‚å­˜æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œå·¥ä½œå†…å®¹ä¸åŸæ¥ç›¸åŒï¼Œä½†æ˜¯SHAä¸åŒï¼Œå› ä¸ºæ—¶é—´æˆ³ä¸åŒã€‚
- `--soft` ç§»åŠ¨åˆ°æš‚å­˜åŒºï¼Œè¿™äº›æ”¹åŠ¨ä»ç„¶å­˜åœ¨ï¼Œè€Œä¸”å·²ç»æš‚å­˜å¥½äº†ã€‚
- `--hard` ä¼šåˆ é™¤å¯¹åº”æ‰€æœ‰çš„æäº¤çš„å†…å®¹ã€‚

ç›´æ¥ç†è§£è¿™äº›é€‰é¡¹æ¯”è¾ƒå›°éš¾ï¼Œä¸‹é¢æˆ‘ä»¬å°†ç»“åˆå›¾ç‰‡ä¸å®é™…ä¾‹å­æ¥è¿›è¡Œè®²è§£ã€‚

##### --mixed ä¾‹å­

åœ¨ä¸‹å›¾ä¸­ï¼Œå‡å¦‚æˆ‘ä»¬çš„ä»“åº“ä¸­å·²ç»æœ‰äº†å¦‚ä¸‹æäº¤ `Dã€Eã€Fã€Gã€H`ï¼Œå…¶ä¸­ `master` æŒ‡å‘æœ€è¿‘çš„æäº¤ `H`ï¼Œ`HEAD` æŒ‡å‘ `master`ã€‚

è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¦‚æœä½¿ç”¨ `git reset --mixed HEAD~1` é‚£ä¹ˆä¼šå°† `master` ä¸ `HEAD` å°†ä¼šæŒ‡å‘å‰ä¸€ä¸ªæäº¤ `G`ã€‚åŒæ—¶ `G` æäº¤ä¼šç§»åŠ¨åˆ°å·¥ä½œç›®å½•ä¸­ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

>æ³¨æ„ï¼Œ`git reset --mixed HEAD~1` ç­‰åŒäº `git reset --mixed HEAD^` ï¼Œä¹Ÿç­‰åŒäº `git reset HEAD~1` (git reset å‘½ä»¤é»˜è®¤é€‰é¡¹ä¸º --mixed)ã€‚

![rest_mixedæ¼”ç¤º.jpg](https://upload-images.jianshu.io/upload_images/2824145-046cfe19a3409594.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å½“ `H` æäº¤ä¿®æ”¹çš„æ–‡ä»¶è¢«ç§»åŠ¨åˆ°åˆ°å·¥ä½œç›®å½•åï¼Œæ–‡ä»¶çš„çŠ¶æ€éƒ½ä¸º `modifed`ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦é‡æ–°æ·»åŠ åˆ°æš‚å­˜åŒºï¼Œç„¶åè¿›è¡Œ commit ã€‚æˆ‘ä»¬ç»§ç»­çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š

![mixed_å±•ç¤º.png](https://upload-images.jianshu.io/upload_images/2824145-7b7bcf70c52623de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

åœ¨ä¸Šè¿°ä»“åº“ä¸­æœ‰3ä¸ªæäº¤ï¼Œå…¶ä¸­ `HEAD` æŒ‡å‘ `bb780f9` ä¸Šçš„ `master` , è¿™ä¸ªæ—¶å€™å¦‚æœæˆ‘ä»¬è¿è¡Œ `git reset HEAD~` å‘½ä»¤ï¼Œä¼šå°† commit `bb780f9` ä¸­çš„æ–‡ä»¶ç§»åŠ¨åˆ°å·¥ä½œç›®å½•ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![mixed_2.png](https://upload-images.jianshu.io/upload_images/2824145-5cf834b7f76dc83d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

è°ƒç”¨ `git status` æ¥æŸ¥çœ‹æˆ‘ä»¬çš„ä»“åº“çŠ¶æ€ï¼Œæˆ‘ä»¬ä¼šå‘ç°ä½¿ç”¨ `--mixed` é€‰é¡¹ï¼Œæ˜¯ä¸ä¼šæš‚å­˜æˆ‘ä»¬çš„æ›´æ”¹çš„ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šå°†ç›¸åº”æäº¤çš„æ–‡ä»¶æ”¾å…¥æš‚å­˜åŒºä¸­ã€‚

##### --soft ä¾‹å­

å½“ä½¿ç”¨ `--soft` é€‰é¡¹æ—¶ï¼Œä¸ä»…ä¼šç§»åŠ¨ `master` ä¸ `HEAD` æŒ‡é’ˆï¼Œè¿˜ä¼šå°†ç›¸åº”ä¿®æ”¹æ·»åŠ åˆ°æš‚å­˜åŒºä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![reset_softæ¼”ç¤º.jpg](https://upload-images.jianshu.io/upload_images/2824145-86bb9a9bbf9c85a8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

æˆ‘ä»¬ç»§ç»­æŸ¥çœ‹ä¸‹é¢çš„ä¾‹å­ï¼š

![softå±•ç¤º.png](https://upload-images.jianshu.io/upload_images/2824145-caef357d1f2b4198.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

##### --hard ä¾‹å­

æœ€åæˆ‘ä»¬å†æ¥çœ‹çœ‹ `--hard` é€‰é¡¹ï¼š

![reset_hardæ¼”ç¤º.jpg](https://upload-images.jianshu.io/upload_images/2824145-903e12026efab806.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ä½¿ç”¨ `--hard` å°†æ¸…é™¤å¯¹åº” commit æ‰€ä½œçš„æ›´æ”¹ï¼Œç»§ç»­æŸ¥çœ‹ä¸‹é¢çš„ğŸ‘‡çš„ä¾‹å­ï¼š

![hardå±•ç¤º.png](https://upload-images.jianshu.io/upload_images/2824145-bc65d682b862de62.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å½“ä½¿ç”¨äº† `--hard` é€‰é¡¹åï¼Œå‘ç°ä»“åº“ä¸­å¯¹åº”çš„æäº¤æ¶ˆå¤±äº†ã€‚

##### å–æ¶ˆæš‚å­˜åŒºä¸­çš„å†…å®¹

å½“æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ `git reset` æˆ– `git reset HEAD`æ—¶ï¼Œè¡¨ç¤ºæ¸…é™¤æš‚å­˜åŒºä¸­çš„ commit ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹è¿™ä¸ªä¾‹å­ï¼š

```bash
edit
git add A.java B.java   (1ï¼‰
git reset               (2)
```

1. æˆ‘ä»¬æ·»åŠ äº†ä¸¤ä¸ªJavaæ–‡ä»¶åˆ°æš‚å­˜åŒºä¸­ã€‚
2. ä½†æ˜¯åœ¨åç»­ä¸­ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬è¿˜éœ€è¦å¯¹è¿™ä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `git reset` å‘½ä»¤å°†è¿™å¦ä¸ªæ–‡ä»¶ä»æš‚å­˜åŒºä¸­ç§»é™¤ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ `git reset HEAD` å‘½ä»¤ï¼Œè¿™ä¸¤ä¸ªå‘½ä»¤æ˜¯ç­‰ä»·çš„ã€‚

é‚£ä¹ˆå¦‚æœæˆ‘ä»¬åªæƒ³å°† `B.java` æ–‡ä»¶ä»æš‚å­˜åŒºä¸­ç§»é™¤ï¼Œé‚£æˆ‘ä»¬åˆè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š

```bash
git reset HEAD B.java
```

å½“ç„¶åœ¨Gitä¸­æ”¯æŒå¤šä¸ªæ–‡ä»¶çš„å–æ¶ˆæš‚å­˜ï¼Œå…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š

```bash
git reset HEAD <file>...
```

åœ¨ä¸Šè¿°å‘½ä»¤ä¸­ `<file>...` ä»£è¡¨ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡ä»¶ã€‚

### IntelliJ IDEA or Android Sutdio å›¾å½¢åŒ–ç•Œé¢çš„ä½¿ç”¨

æœ€åè¿˜æ˜¯å›åˆ°æˆ‘ä»¬ç†Ÿæ‚‰çš„å›¾å½¢åŒ–ç•Œé¢çš„ä½¿ç”¨æµç¨‹ä¸­ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹IDEAä¸ºæˆ‘ä»¬æä¾›äº†å“ªäº›ä¾¿åˆ©å§ã€‚

#### ä½¿ç”¨ git commit --amend

åœ¨åˆ›å»ºç›¸åº” `commmit` æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‹¾é€‰ä¸‹å›¾ä¸­çš„
`Amend commit` é€‰é¡¹ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š

![ide_amend.png](https://upload-images.jianshu.io/upload_images/2824145-6bdf8b264ab654dd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ä¸Šè¿°æ“ä½œä¸ä½¿ç”¨ `git commit --amend` å‘½ä»¤çš„æ•ˆæœä¸€æ ·ã€‚

#### ä½¿ç”¨ git revert

é€šè¿‡ä¾æ¬¡ç‚¹å‡»ç¼–è¯‘å™¨åº•éƒ¨çš„`Version Control`->`Log`ï¼Œç„¶åé€‰æ‹©æƒ³è¦ revert çš„ commit ï¼Œç‚¹å‡»é¼ æ ‡`å³é”®`ï¼Œé€‰æ‹© `Revert Commit` å°±å¯ä»¥å•¦~

![ide_revert.png](https://upload-images.jianshu.io/upload_images/2824145-fee04c55bcf1c6c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

#### ä½¿ç”¨ git reset

é€šè¿‡ä¾æ¬¡ç‚¹å‡»ç¼–è¯‘å™¨åº•éƒ¨çš„`Version Control`->`Log`ï¼Œç„¶åé€‰æ‹©æƒ³è¦ reset çš„ commit ï¼Œç‚¹å‡»é¼ æ ‡`å³é”®`ï¼Œé€‰æ‹© `Reset Current Branch to Here..` å°±å®Œæˆç¬¬ä¸€æ­¥å•¦~

![ide_reset_1.png](https://upload-images.jianshu.io/upload_images/2824145-b1a4faa24e390f4c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

å½“ç„¶åœ¨ç¬¬äºŒæ­¥ä¸­ï¼Œæˆ‘ä»¬éœ€è¦é€‰æ‹© `git reset` ä¸­çš„é€‰é¡¹ï¼Œåœ¨ IDEA ä¸­æä¾›äº†å››ç§é€‰é¡¹ `Softã€Mixedã€Hardã€Keep` ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

![ide_reset_2.png](https://upload-images.jianshu.io/upload_images/2824145-8d64de035894b139.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

åœ¨ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬ä¸ç†Ÿæ‚‰çš„åªæœ‰ `--keep` é€‰é¡¹ï¼Œå› ä¸ºè¯¥é€‰é¡¹åœ¨å¹³æ—¶ä¸­çš„é¡¹ç›®å¹¶ä¸å¸¸ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸åšæ›´å¤šä»‹ç»äº†ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´ï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ä¸­ [git reset](https://git-scm.com/docs/git-reset) ä¸­å¯¹å…¶çš„ä»‹ç»ã€‚

### æœ€å

ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œæ‰èƒ½çœ‹çš„æ›´è¿œ~

- [git reset](https://git-scm.com/docs/git-reset)
- [æ’¤é”€æ›´æ”¹](https://classroom.udacity.com/courses/ud123/lessons/f02167ad-3ba7-40e0-a157-e5320a5b0dc8/concepts/50740c4a-054c-46da-910a-8d1344b18d33)
